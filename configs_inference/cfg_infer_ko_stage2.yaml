model:
  target: "src.trainer.CtrlBase.ControlBase"
  params:
    control_config:
      target: "src.trainer.CtrlBase.StylePyramidNet"
      params:
        image_size: 256
        patch_size: 16
        in_channels: 3
        embed_dim: 768
        model_channels: 320
        channel_mult: [ 1, 2, 4, 4 ]
        pyramid_sizes: [ 32, 16, 8, 4 ]

    base_config:
      noise_scheduler: "diffusers.PNDMScheduler"
      scheduler_config: "weights/sd/scheduler/scheduler_config.json"
      num_inference_steps: 50
      min_training_steps: 0

      vae:
        pretrained: "weights/sd/vae/"
        normalizer: 0.18215

      text_encoder_optimized: False
      text_encoder:
        target: "src.module.textencoder.modules.LanguageAdaptiveLabelEncoder"
        params:
          max_len: 12
          emb_dim: 768
          lang: "ko"
          character_path: "preglyph/data/character_ko.txt"
          ckpt_path: "weights/text_encoder_ko.pth"

      unet_pretrained: "weights/sd/unet/diffusion_pytorch_model.bin"
      unet:
        target: "src.trainer.CtrlBase.ControlUNetModel"
        params:
          cross_attention_dim: 768

      reconstruction_loss: True
      cond_on_text_image: False
      font_path: "datagen/fonts/ko_ttf/NanumGothic.ttf"
      
      ocr_model:
        lang: "ko"
        height: 48
        width: 320
        use_gpu: true
        max_length: 13
        iter_size: 3

inference:
  seed: 42
  target_height: 256
  teaget_width: 256
  style_height: 256
  style_width: 256
  ckpt_path: "weights/model_stage2_ko.pth"
  dataset_dir: "./STIPLAR-ko-eval/"
  dataset_style_dir: "i_s"
  dataset_style_txt: "i_s.txt"
  dataset_target_txt: "i_t.txt"
  output_dir: "generated/STIPLAR_stage2_ko/"
  num_inference_steps: 50
  guidance_scale: 2
  max_length: 13
